<section id="eventos">
    <h2>ğŸ“… Eventos de esta Semana</h2>

    <div class="content-block intro-block">
        <h3>Participa en nuestras actividades</h3>
        <p>Descubre los prÃ³ximos eventos de la Iglesia Asambleas de Dios "El Puerto". Cada semana tenemos actividades que fortalecen la fe, el compaÃ±erismo y el servicio a Dios.</p>
    </div>

    <div class="content-block">
        <div id="eventCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="6000">
            <div class="carousel-inner" id="carouselContent">
                <div class="text-center text-muted py-4">Cargando eventos...</div>
            </div>

            <button class="carousel-control-prev" type="button" data-bs-target="#eventCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#eventCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
            </button>
        </div>
    </div>
</section>

<script>
    async function cargarEventos() {
        try {
            const response = await fetch('/assets/jss/eventos.json');
            const eventos = await response.json();

            const hoy = new Date();
            const inicioSemana = new Date(hoy);
            inicioSemana.setDate(hoy.getDate() - hoy.getDay());
            const finSemana = new Date(inicioSemana);
            finSemana.setDate(inicioSemana.getDate() + 6);

            const eventosSemana = eventos.filter(e => {
                const fecha = new Date(e.fecha_inicio);
                return fecha >= inicioSemana && fecha <= finSemana;
            });

            mostrarEventos(eventosSemana);
        } catch (error) {
            document.getElementById('carouselContent').innerHTML =
                "<div class='text-danger py-4'>Error cargando eventos.</div>";
        }
    }

    function mostrarEventos(eventos) {
        const contenedor = document.getElementById('carouselContent');
        contenedor.innerHTML = '';

        if (eventos.length === 0) {
            contenedor.innerHTML = "<div class='text-muted py-4'>No hay eventos esta semana.</div>";
            return;
        }

        eventos.forEach((evento, i) => {
            const item = document.createElement('div');
            item.className = `carousel-item ${i === 0 ? 'active' : ''}`;
            item.innerHTML = `
                <div class="ministry-item mx-auto" style="max-width: 700px;">
                    <img src="${evento.imagen}" alt="${evento.nombre}">
                    <div class="ministry-item-content">
                        <h4>${evento.nombre}</h4>
                        <p><strong>ğŸ“ Lugar:</strong> ${evento.lugar}</p>
                        <p><strong>ğŸ•’ Hora:</strong> ${evento.hora}</p>
                        <p><strong>ğŸ“… Fecha:</strong> ${evento.fecha_inicio}</p>
                        <p>${evento.descripcion}</p>
                    </div>
                </div>`;
            contenedor.appendChild(item);
        });
    }

    cargarEventos();
</script>
